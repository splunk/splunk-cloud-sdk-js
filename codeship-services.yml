ssc-sdk-shared-tenant-creation:
  image: 137462835382.dkr.ecr.us-west-1.amazonaws.com/ssc-sdk-shared-tenant-creation:temporary
  dockercfg_service: aws-generator
  encrypted_env_file: ci/env.encrypted
  volumes_from:
    - ssc-sdk-shared-token-fetcher
  depends_on:
    - ssc-sdk-shared-token-fetcher
  volumes:
    - ./.config/ssc:/opt/splunk/ssc-sdk-shared/ssc
    - ./.config/okta:/opt/splunk/ssc-sdk-shared/okta

ssc-sdk-shared-tenant-deletion:
  image: 137462835382.dkr.ecr.us-west-1.amazonaws.com/ssc-sdk-shared-tenant-creation:temporary-deletion
  dockercfg_service: aws-generator
  encrypted_env_file: ci/env.encrypted
  volumes_from:
    - ssc-sdk-shared-token-fetcher
    - ssc-sdk-shared-tenant-creation
  depends_on:
    - ssc-sdk-shared-token-fetcher
    - ssc-sdk-shared-tenant-creation
  volumes:
    - ./.config/ssc:/opt/splunk/ssc-sdk-shared/ssc
    - ./.config/okta:/opt/splunk/ssc-sdk-shared/okta

ssc-sdk-shared-token-fetcher:
  image: 137462835382.dkr.ecr.us-west-1.amazonaws.com/ssc-sdk-shared-token-fetcher:latest
  dockercfg_service: aws-generator
  encrypted_env_file: ci/env.encrypted
  volumes:
    - ./.config/okta:/okta

ssc-client-js-with-stubby:
  build:
    image: splunk/ssc-client-js-with-stubby
    dockerfile: ci/Dockerfile
  encrypted_env_file: ci/env.encrypted
  environment:
    - CI=true
  depends_on:
    - ssc-sdk-shared-stubby

ssc-client-js-against-playground:
  build:
    image: splunk/ssc-client-js-against-playground
    dockerfile: ci/Dockerfile
  encrypted_env_file: ci/env.encrypted
  depends_on:
    - ssc-sdk-shared-token-fetcher
    - ssc-sdk-shared-tenant-creation
  volumes_from:
    - ssc-sdk-shared-token-fetcher
    - ssc-sdk-shared-tenant-creation
  environment:
    - CI=true

ssc-sdk-shared-stubby:
  image: 137462835382.dkr.ecr.us-west-1.amazonaws.com/ssc-sdk-shared-stubby:latest
  dockercfg_service: aws-generator

aws-generator:
  add_docker: true
  image: codeship/aws-ecr-dockercfg-generator
  encrypted_env_file: ci/shared/env.encrypted
