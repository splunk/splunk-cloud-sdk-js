# Syntax at https://github.com/mrak/stubby4node#endpoint-configuration
# todo: Authorization change to use test credential
#-  request:
#      url: /datasets/set1/conf
#      method: GET
#   response:
#      headers:
#         Content-Type: application/json
#         Authorization: Basic YWRtaW46Y2hhbmdlbWU=
#      latency: 1 // Only here to remind me of the option
#      status: 200
#      body:
#            foo: <% url[0] %>

#curl  http://0.0.0.0:8882/dataset/ds1
-  request:
      url: /catalog/v1/datasets/ds1
      method: GET
   response:
      headers:
         Content-Type: application/json
         Authorization: Basic YWRtaW46Y2hhbmdlbWU=
      latency: 1 // Only here to remind me of the option
      status: 200
      body:
          {
            "id": "5ac3d5170ed3330007caab65",
            "name": "ds1",
            "kind": ""
          }
#
#-  request:
#      url: /catalog/v1/datasets/
#      method: PUT
#   response:
#      headers:
#         Content-Type: application/json
#         Authorization: Basic YWRtaW46Y2hhbmdlbWU=
#      json: '{"friar":"tuck"}'
#      status: 200
#      body:
#            friar: name

#-  request:
#      url: /catalog/v1/datasets/:name
#      method: DELETE
#   response:
#      headers:
#         Content-Type: application/json
#         Authorization: Basic YWRtaW46Y2hhbmdlbWU=
#      status: 204


# /datasets
-  request:
      url: /catalog/v1/datasets
      method: GET
   response:
      headers:
         Content-Type: application/json
         Authorization: Basic YWRtaW46Y2hhbmdlbWU=
      status: 200
      body:
            '[
              {
                "id": "string",
                "name": "myname",
                "kind": "VIEW",
                "rules": [
                  "string"
                ],
                "todo": "string"
              },
              {
                "id": "string",
                "name": "ds1",
                "kind": "VIEW",
                "rules": [
                  "string"
                ],
                "todo": "string"
              }
            ]'

# curl  -X POST http://0.0.0.0:8882/catalog/v1/datasets
-  request:
      url: /catalog/v1/datasets
      method: POST
      json: '{
                "id": "string",
                "name": "myname",
                "kind": "VIEW",
                "rules": [
                  "string"
                ],
                "todo": "string"
            }'
   response:
      headers:
         Content-Type: application/json
      status: 201
      body: '{
                "id": "string",
                "name": "myname",
                "kind": "VIEW",
                "rules": [
                  "string"
                ],
                "todo": "string"
            }'


-  request:
      url: /catalog/v1/rules
      method: GET
   response:
      headers:
         Content-Type: application/json
         Authorization: Basic YWRtaW46Y2hhbmdlbWU=
      status: 200
      body:
        [
          {
            "name": "rule1",
            "match": "newrule",
            "priority": 7,
            "description": "first rule",
            "actions": [
              {
                "kind": "AUTOKV",
                "mode": "NONE",
                "trim": true
              },
              {
                "kind": "EVAL",
                "expression": "string",
                "result": "string"
              },
              {
                "kind": "LOOKUP",
                "expression": "string"
              }
            ]
          }
        ]

# curl  -X POST http://0.0.0.0:8882/catalog/v1/rules
-  request:
      url: /catalog/v1/rules
      method: POST
      json:
        '{
          "name": "rule1",
          "match": "newrule",
          "priority": 7,
          "description": "first rule",
          "actions": [
            {
              "kind": "AUTOKV",
              "mode": "NONE",
              "trim": true
            },
            {
              "kind": "EVAL",
              "expression": "string",
              "result": "string"
            },
            {
              "kind": "LOOKUP",
              "expression": "string"
            }
          ]
        }'

   response:
      headers:
         Content-Type: application/json
      status: 201
      body:
        '{
          "name": "rule1",
          "match": "newrule",
          "priority": 7,
          "description": "first rule",
          "actions": [
            {
              "kind": "AUTOKV",
              "mode": "NONE",
              "trim": true
            },
            {
              "kind": "EVAL",
              "expression": "string",
              "result": "string"
            },
            {
              "kind": "LOOKUP",
              "expression": "string"
            }
          ]
        }'
